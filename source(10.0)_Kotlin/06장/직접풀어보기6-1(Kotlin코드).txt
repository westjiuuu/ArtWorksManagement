package com.cookandroid.self6_1

import android.graphics.Color
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import android.os.SystemClock
import android.view.View
import android.widget.*


class MainActivity : AppCompatActivity() {

    lateinit var chrono : Chronometer
    lateinit var rdoCal : RadioButton
    lateinit var rdoTime : RadioButton
    lateinit var dPicker : DatePicker
    lateinit var tPicker : TimePicker
    lateinit var tvYear : TextView
    lateinit var tvMonth : TextView
    lateinit var tvDay : TextView
    lateinit var tvHour : TextView
    lateinit var tvMinute : TextView

    public override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        title = "시간 예약"

        // 크로노미터
        chrono = findViewById<View>(R.id.chronometer1) as Chronometer

        // 라디오버튼 2개
        rdoCal = findViewById<View>(R.id.rdoCal) as RadioButton
        rdoTime = findViewById<View>(R.id.rdoTime) as RadioButton

        // FrameLayout의 2개 위젯
        dPicker = findViewById<View>(R.id.datePicker1) as DatePicker
        tPicker = findViewById<View>(R.id.timePicker1) as TimePicker

        // 텍스트뷰 중에서 연,월,일,시,분 숫자
        tvYear = findViewById<View>(R.id.tvYear) as TextView
        tvMonth = findViewById<View>(R.id.tvMonth) as TextView
        tvDay = findViewById<View>(R.id.tvDay) as TextView
        tvHour = findViewById<View>(R.id.tvHour) as TextView
        tvMinute = findViewById<View>(R.id.tvMinute) as TextView

        // 처음에는 2개를 안보이게 설정
        rdoCal.visibility = View.INVISIBLE
        rdoTime.visibility = View.INVISIBLE
        tPicker.visibility = View.INVISIBLE
        dPicker.visibility = View.INVISIBLE

        rdoCal.setOnClickListener {
            tPicker.visibility = View.INVISIBLE
            dPicker.visibility = View.VISIBLE
        }

        rdoTime.setOnClickListener {
            tPicker.visibility = View.VISIBLE
            dPicker.visibility = View.INVISIBLE
        }

        // 크로노미터를 클릭하면..타이머 시작
        chrono.setOnClickListener {
            chrono.base = SystemClock.elapsedRealtime()
            chrono.start()
            chrono.setTextColor(Color.RED)
            rdoCal.visibility = View.VISIBLE
            rdoTime.visibility = View.VISIBLE
        }

        // 아래쪽 연도를 롱클릭하면..타이머 중지
        tvYear.setOnLongClickListener {
            chrono.stop()
            chrono.setTextColor(Color.BLUE)

            tvYear.text = Integer.toString(dPicker.year)
            tvMonth.text = Integer.toString(1 + dPicker.month)
            tvDay.text = Integer.toString(dPicker.dayOfMonth)

            tvHour.text = Integer.toString(tPicker.currentHour)
            tvMinute.text = Integer.toString(tPicker.currentMinute)

            rdoCal.visibility = View.INVISIBLE
            rdoTime.visibility = View.INVISIBLE
            tPicker.visibility = View.INVISIBLE
            dPicker.visibility = View.INVISIBLE
            false
        }

    }

}